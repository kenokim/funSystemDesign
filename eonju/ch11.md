뉴스 피드(news feed) : 페이스북의 도움말 페이지에서는 “뉴스 피드는 여러분의 홈 페이지 중앙에 지속적으로 업데이트되는 스토리로, 사용자 상태 정복 업데이트, 사진, 비디오, 링크, 앱 활동(app activity), 그리고 여러분이 페이스북에서 팔로하는 사람들, 페이지, 또는 그룹으로부터 나오는 ‘좋아요’ 등을 포함하고 있다”고 설명한다.

### 1단계 문제 이해 및 설계 범위 확정

면접관의 의도는 무엇이었는지 질문을 통해 알아내야 한다.

- 웹 / 모바일 지원?
- 중요한 기능?
- 어떤 순서로 표시되어야하는지?
- 트래픽의 규모는?
- 피드에 올라올 수 있는 미디어 유형

### 2단계 개략적 설계안 제시 및 동의 구하기

(1) 피드 발행(feed publishing) : 사용자가 스토리를 포스팅하면 해당 데이터를 캐시와 데이터베이스에 기록한다. 새 포스팅은 친구의 뉴스 피드에도 전송된다.

(2) 뉴스 피드 생성(news feed building) : 지면 관계상 뉴스 피드는 모든 친구의 포스팅을 시간 흐름 역순으로 모아서 만든다고 가정한다.

뉴스 피드 API : 클라이언트-서버 간에 통신하기 위한 수단이다.

- 피드 발행 API
    - post 형태로 요청
- 피드 읽기 API
- 피드 발행 시스템 설계
- 뉴스 피드 생성

### 3단계 상세 설계

피드 발행 흐름의 상세 설계안

웹 서버와 포스팅 전송 서비스에 초점을 맞추었다**.**

**웹 서버**

클라이언트 통신 뿐 아니라 인증, 처이율 제한 등의 기능도 수행한다.

특정 기간 동안 한 사용자가 올릴 수 있는 포스팅의 수에 제한을 두어야 한다.

**포스팅 전송(팬아웃) 서비스**

팬 아웃은 어떤 사용자의 새 포스팅을 그 사용자와 친구 관계에 있는 모든 사용자에게 전달하느 ㄴ과정

---

**질문 1: 뉴스 피드 시스템에서 Push 모델과 Pull 모델의 장단점은 무엇인가요? 각 모델의 사용 사례를 설명해주세요.**

**답변:**
Push 모델과 Pull 모델은 뉴스 피드 시스템에서 콘텐츠를 사용자에게 전달하는 두 가지 접근 방식입니다.

- **Push 모델:**
    - **장점:**
        - 실시간으로 뉴스 피드가 갱신되어 사용자 경험이 향상됩니다.
        - 피드 읽기 속도가 빠릅니다. 사용자가 요청할 때 이미 피드가 최신 상태로 준비되어 있습니다.
    - **단점:**
        - 친구가 많은 사용자의 경우, 모든 친구의 피드를 갱신하는 데 시간이 오래 걸려 핫키(Hot Key) 문제가 발생할 수 있습니다.
        - 비활성 사용자의 피드도 갱신되므로 불필요한 자원 낭비가 발생할 수 있습니다.
    - **사용 사례:**
        - 일반 사용자들에게 실시간으로 피드를 제공하는 경우 사용됩니다. 자주 로그인하는 사용자가 많은 경우 효과적입니다.
- **Pull 모델:**
    - **장점:**
        - 사용자가 요청할 때만 피드가 갱신되므로, 비활성 사용자에 대해 리소스를 절약할 수 있습니다.
        - 핫키 문제를 방지할 수 있습니다.
    - **단점:**
        - 피드를 읽는 데 시간이 오래 걸릴 수 있으며, 실시간 업데이트가 어렵습니다.
    - **사용 사례:**
        - 유명인이나 팔로워가 많은 사용자의 피드 갱신에 사용됩니다. 과도한 트래픽을 방지하고, 서버 부하를 줄이는 데 효과적입니다.

**질문 2: 뉴스 피드 시스템에서 데이터베이스 확장 방법으로 수직적 확장과 수평적 확장이 있습니다. 각각의 장단점을 설명하고, 뉴스 피드 시스템에 적합한 방식을 추천해 보세요.**

**답변:**

- **수직적 확장(Vertical Scaling):**
    - **장점:**
        - 시스템을 관리하기 쉽고, 단일 서버에서 성능이 개선됩니다.
        - 애플리케이션 변경이 거의 필요 없습니다.
    - **단점:**
        - 하드웨어 한계로 인해 확장성이 제한됩니다.
        - 비용이 높을 수 있습니다.
    - **사용 사례:**
        - 소규모 시스템이나 초기 단계의 시스템에 적합합니다.
- **수평적 확장(Horizontal Scaling):**
    - **장점:**
        - 더 많은 서버를 추가하여 무한에 가까운 확장성을 제공합니다.
        - 장애 복구 및 부하 분산이 용이합니다.
    - **단점:**
        - 시스템 관리가 복잡하고, 데이터베이스 샤딩과 같은 추가적인 설계가 필요합니다.
        - 데이터 일관성 유지가 어려울 수 있습니다.
    - **사용 사례:**
        - 대규모 사용자 기반을 가진 시스템, 높은 트래픽을 처리해야 하는 시스템에 적합합니다.

**추천:** 뉴스 피드 시스템은 대규모 사용자와 높은 트래픽을 처리해야 하므로, 수평적 확장이 적합합니다. 이는 더 많은 사용자가 증가할 때 서버를 추가하여 효율적으로 확장할 수 있고, 장애 복구에도 유리하기 때문입니다.

**질문 3: 뉴스 피드 시스템에서 캐시를 사용하는 이유는 무엇이며, 어떤 종류의 데이터를 캐시에 저장해야 할까요?**

**답변:**
캐시는 데이터베이스나 외부 API 호출을 줄이고, 응답 속도를 높이기 위해 사용됩니다. 뉴스 피드 시스템에서 캐시는 다음과 같은 이유로 중요합니다:

- **응답 시간 단축:** 사용자 요청에 빠르게 응답하여 사용자 경험을 향상시킵니다.
- **서버 부하 감소:** 데이터베이스와 API 호출 수를 줄여 서버 부하를 줄입니다.
- **실시간 업데이트 지원:** 자주 요청되는 데이터나 변경 빈도가 높은 데이터를 캐시에 저장하여 실시간으로 빠르게 제공할 수 있습니다.

**저장할 데이터:**

- **뉴스 피드 ID 목록:** 사용자 피드에 포함된 포스팅 ID를 저장하여 빠르게 조회할 수 있습니다.
- **콘텐츠 데이터:** 인기 포스팅이나 미디어 파일 등을 캐시에 저장하여 빠르게 렌더링할 수 있습니다.
- **사용자 행동 데이터:** ‘좋아요’ 수, 댓글 등 사용자 행동 관련 데이터를 저장하여 사용자 경험을 개선합니다.
- **소셜 그래프:** 사용자 관계(팔로워, 팔로잉)를 저장하여 친구 관계 조회를 빠르게 할 수 있습니다.

**질문 4: 뉴스 피드 시스템에서 메시지 큐를 사용하는 이유는 무엇이며, 이를 통해 얻을 수 있는 이점은 무엇인가요?**

**답변:**
메시지 큐는 비동기 작업을 관리하고, 시스템의 각 컴포넌트 간 결합도를 낮추는 데 사용됩니다.

- **이유:**
    - **비동기 처리:** 메시지 큐를 사용하면 포스팅을 바로 처리하지 않고, 나중에 처리할 수 있습니다. 이는 시스템이 즉각적인 부하를 피하는 데 도움이 됩니다.
    - **확장성:** 메시지 큐는 부하가 증가해도 확장 가능하며, 병렬 처리로 효율적으로 작업을 분산할 수 있습니다.
    - **결합도 감소:** 시스템 구성 요소 간의 결합도를 낮춰 독립적으로 확장 및 유지보수가 가능합니다.
- **이점:**
    - **성능 향상:** 피드 갱신이나 알림 전송 같은 작업을 비동기로 처리하여 응답 시간을 줄입니다.
    - **내구성 및 안정성:** 메시지를 손실하지 않고 보관할 수 있어, 시스템이 다운되더라도 작업을 다시 수행할 수 있습니다.
    - **유연성:** 다양한 처리 속도를 가진 컴포넌트들이 메시지를 처리할 수 있도록 조율할 수 있습니다.

**질문 5: 시스템의 핵심 메트릭을 모니터링하는 이유와 모니터링해야 할 주요 메트릭은 무엇인가요?**

**답변:**
시스템의 성능과 안정성을 보장하기 위해 핵심 메트릭을 모니터링하는 것이 중요합니다. 이를 통해 문제를 조기에 발견하고, 시스템을 최적화할 수 있습니다.

**주요 메트릭:**

- **QPS(Queries Per Second):** 초당 처리 요청 수로, 시스템의 처리 능력을 나타냅니다.
- **응답 시간:** 사용자가 요청한 작업이 완료되기까지 걸리는 시간으로, 사용자 경험에 직접적인 영향을 미칩니다.
- **캐시 적중률:** 캐시에서 요청을 성공적으로 처리한 비율로, 캐시 사용의 효율성을 나타냅니다.
- **오류율:** 시스템에서 발생하는 오류의 비율로, 시스템의 신뢰성을 측정합니다.
- **서버 사용량:** CPU, 메모리 사용량 등을 모니터링하여 시스템 리소스가 적절히 사용되고 있는지 확인합니다.
