- Topic
    - 분산 시스템에서는 유일한 ID 생성기를 어떻게 설계하여야 하나?

유일 ID 생성 방법

- auto_increment 사용
- 다중 마스터 복제(multi-master replication)
    - auto-increment를 사용하며 **서버의 수만큼 값을 증가**시켜 얻는 방식
    - 만약 두 대의 db가 있는 경우 ex) 1번 db - 1, 3, 5… / 2번 db - 2, 4, 6…
    - 장단점
        - 규모 확장성 문제를 어느 정도 해결할 수 있다.
        - 데이터 베이스의 수를 늘리면 초당 생산 가능 ID 수도 늘릴 수 있다.
        - 여러 데이터 센터에 결처 규모를 늘리기 어렵다.
        - ID의 유일성은 보장되겠지만 그 값이 시간 흐름에 맞추어 커지도록 보장할 수는 없다.
        - 서버를 추가하거나 삭제할 때도 잘 동작하도록 만들기 어렵다.
- UUID(Universally Unique Identifier)
    - 128비트 짜리 수
    - 초당 10억개의 uuid를 100년 동안 계속 만들어야지 하나의 아이디가 중복될 확률이 50%가 된다.
    - 장단점
        - UUID를 만드는 것이 단순하다. 동기화 이슈가 없다.
        - 각 서버가 자기가 쓸 ID를 알아서 만드는 구조이므로 규모 확장이 쉽다.
        - ID가 128비트로 길다.
        - 시간 순으로 정렬할 수 없다.
        - 숫자가 아닌 값이 포함될 수 있다.
- 티켓 서버(Ticket Server)
    - auto_increment 기능을 갖춘 하나의 티켓서버를 두어 중앙 집중형으로 관리하는 방식
    - 장단점
        - 유일성이 보장되는 오직 숫자로만 구성된 ID를 쉽게 만들 수 있다.
        - 구현하기 쉽고, 중소 규모 애플리케이션에 적합
        - 티켓서버가 SOFP(Single-Point-Of-Failure)가 된다. 만약 다중화를 한다면 동기화 같은 문제가 발생할 것이다.
- 트위터 스노플레이크(twitter wnowflake) 접근법
    - 각개 격파 전략(divide and conquer)를 적용해 생성해야할 ID의 구조를 여러 절(section)로 분할하는 것.
    - sign, 타임스탬프, 데이터 센터 ID, 서버 ID, 일련번호 로 구성된 방식
    - 고민해볼 수 있는 부분
        - 시계 동기화
        - 각 절의 길이 최적화
        - 고가용성
