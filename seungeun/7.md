# 분산 시스템을 위한 유일 ID 생성기

### 요구사항
- ID는 유일해야 한다.
- ID는 숫자로만 구성되어야 한다.
- ID는 발급 날짜에 따라 정렬 가능해야 한다.
- 초당 10,000개의 ID를 만들 수 있어야 한다.


## 1. 다중 마스터 복제
DB의 auto_increment 기능을 활용
다음 ID 값은 서버의 수 k 만큼 증가하여 구하여 중복을 피한다. ex: 1, 1+k, 1+2k ...

다음과 같은 단점이 있다.
- 데이터 센터 확장에 불리
- 시간에 따른 ID의 순서가 보장되지 않음
- 서버의 확장과 축소에 유지보수 비용이 크게 발생

## 2. UUID
UUID는 컴퓨터 시스템에 저장되는 정보를 유일하게 식별하기 위한 128비트짜리 수다.
<br>
중복 가능성이 매우 낮고 서버 간 조율 없이 독립적으로 생성 가능하다는 장점이 있다.
<br>
단점으로는 ID가 128비트로 길다. 또한 시간 순으로 정렬할 수 없고 숫자가 아닌 값이 포함될 수 있다.

## 3. 티켓 서버
auto_increment 기능을 갖춘 데이터베이스 서버, 즉 티켓 서버를 중앙 집중형으로 하나만 사용한다.
<br>
유일성이 보장되는 오직 숫자로만 구성된 ID를 쉽게 만들 수 있다. 또한 구현하기 쉽고, 중소 규모 애플리케이션에 적합하다.
<br>
티켓 서버가 SPOF가 된다는 단점이 있다. 티켓 서버에 장애가 발생하면 해당 서버를 이용하는 모든 시스템이 영향을 받는다. 이를 방지하기 위해 티켓 서버를 여러 대 준비하면 동기화 문제가 발생한다.

## 4. 스노플레이크
먼저 ID의 구조를 여러 절로 다음처럼 분할한다.
<br>
사인 비트: 1 비트를 할당한다.
<br>
타임스탬프: 41비트를 할당한다. 단위는 밀리초이다.
<br>
데이터센터 ID: 5비트를 할당한다.
<br>
서버 ID: 5비트를 할당한다.
<br>
일련번호: 12비트를 할당한다. ID 생성 시 1만큼 증가시키고 1밀리초가 경과하면 0으로 초기화한다. 

41비트로 표현할 수 있는 시간은 약 69년이다. 즉 69년이 지나면 기원 시각을 바꾸거나 ID 체계를 다른 것으로 이전하여야 한다.

일련번호는 12비트이므로, 한 서버는 1밀리초당 최대 4096개의 ID를 생성할 수 있다.
