# URL 단축기 설계

### 요구사항
- URL 단축: 주어진 긴 URL을 훨씬 짧게 줄인다.
- URL 리다이렉션: 축약된 URL로 HTTP 요청이 오0 원래 URL로 안내
- 높은 가용성과 규모 확장성, 그리고 장애 감내가 요구됨

### 개략적 추정
- 쓰기 연산: 매일 1억 개의 단축 URL 생성
- 초당 쓰기 연산: 약 1160
- 읽기 연산: 쓰기 연산의 10배인 약 11600
- URL 단축 서비스를 10년간 운영한다고 가정하면 약 3650억개의 레코드를 보관해야 한다.
- 축약 전 URL의 평균 길이는 100이라고 하자
- 따라서 10년 동안 필요한 저장 공간은 약 36.5TB 이다.

### API 엔드포인트
1. URL 단축용 엔드포인트
- POST /api/v1/data/shorten
<br>
Request: {longUrl: longURLstring}
Response: 단축 URL

2. URL 리다이렉션용 엔드포인트
- GET /api/v1/shortUrl


### 리다이렉션 방식

301 Permanently Moved: 이 응답은 영구적으로 URL이 이전되었다는 응답이다. 그러므로 브라주얻는 이 응답을 캐시한다.
302 Found: 이 응답은 주어진 URL로의 요청이 일시적으로 Location 헤더가 지정하는 URL에 의해 처리되어야 한다는 응답이기에 클라이언트의 요청은 항상 단축 URL -> 응답 URL로 리다이렉션되어야 한다.

301은 서버 부하를 줄이는데 효과적이고 302는 트래픽 분석에 유리하다.

### URL 단축
단축 URL에 사용될 수 있는 문자는 숫자와 대소문로 총 62개다. 3650억 개의 URL을 만들어야 하므로 URL의 길이는 7로 정한다. (62^7 = 약 3.5조)

### 해시 후 충돌 해소
해시 생성 후 충돌이 있다면 URL 뒤에 특정 문자열을 붙여 충돌을 해소 할 수 있다. 다만 이 방법은 DB를 한 번 이상 질의해야 하므로 오버헤드가 크다. 블룸 필터를 쓰면 성능을 높일 수 있다.

### base-62
ID를 발급하고 62진수로 변환하여 값을 얻는다.
따라서 유일성을 보장하는 ID 생성기가 필요하다.